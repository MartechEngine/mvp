Phase: 4 - Monetization & Billing
Part: 4.6
Title: Enterprise Frontend Pricing Page UI
Depends On: 4.2-Backend-Billing-API.md

**Objective:** To design and specify the frontend architecture for a secure, user-friendly, and responsive pricing page. This page will be the primary interface for users to understand subscription tiers, purchase AI credit packs, and initiate the checkout process by integrating with the backend billing API and Razorpay payment gateway.

### 1. Core Principles

*   **Clarity & Transparency:** Pricing tiers and the value proposition of each must be presented clearly. Users should easily understand what they are purchasing.
*   **Trust & Security:** The checkout process must feel secure. We will achieve this by using Razorpay's secure checkout modal, ensuring that sensitive card details are never handled by our servers.
*   **Responsive Design:** The page must be fully responsive and provide an excellent user experience on all devices, from desktops to mobile phones.
*   **Action-Oriented:** The UI will guide the user towards making a purchase decision with clear calls-to-action (CTAs).

### 2. Component Breakdown

The pricing page will be composed of several modular React components:

*   **`PricingPage.tsx`**: The main container component that orchestrates the layout and fetches plan data.
*   **`PlanSelector.tsx`**: A component that displays the different subscription plans (e.g., Free, Pro, Enterprise) in a comparison table format. It will highlight the features of each plan.
*   **`CreditPackSelector.tsx`**: A component that displays the available one-time AI credit packs for purchase.
*   **`CheckoutModal.tsx`**: A component that integrates with Razorpay's checkout modal for secure payment processing. This component will handle the payment initiation and callback processing.
*   **`usePricingAPI.ts`**: A custom React Query hook to encapsulate all API interactions with the backend's `/api/v1/billing` endpoints.

### 3. Data Flow & State Management

1.  **Fetch Plans:** On page load, the `usePricingAPI` hook will call the `GET /api/v1/billing/plans` endpoint to retrieve the available subscription plans and credit packs.
2.  **User Selection:** The user selects a plan or a credit pack. This selection is stored in the local component state.
3.  **Initiate Purchase:** Clicking a "Purchase" button triggers a call to `POST /api/v1/billing/credits/purchase` via the `usePricingAPI` hook, sending the selected `credit_package_id`.
4.  **Receive Order Details:** The backend returns a `CreditPurchaseInitiation` response containing the `provider_order_id`, `amount`, `currency`, and other order details.
5.  **Launch Razorpay Checkout:** The order details are passed to the `CheckoutModal.tsx` component, which uses Razorpay's JavaScript SDK to open the secure checkout modal with the `provider_order_id`.
6.  **Handle Payment:** The user completes payment within Razorpay's secure modal. Razorpay handles all payment processing and PCI compliance.
7.  **Process Callback:** After payment completion, Razorpay triggers success/failure callbacks. The frontend handles these callbacks to show appropriate success/error messages and refresh the user's credit balance.

### 4. API Integration

The `usePricingAPI.ts` custom hook will manage the following API calls:

*   **`getPlans`**: `GET /api/v1/billing/plans`
    *   **Purpose:** Fetches all available subscription plans and credit packs.
    *   **React Query:** Uses `useQuery` for caching plan data.
*   **`purchaseCredits`**: `POST /api/v1/billing/credits/purchase`
    *   **Purpose:** Initiates a credit purchase and returns Razorpay order details including `provider_order_id`.
    *   **React Query:** Uses `useMutation` to handle the POST request.
*   **`getCurrentSubscription`**: `GET /api/v1/billing/subscription`
    *   **Purpose:** Fetches the user's current subscription status to enforce business rules.
    *   **React Query:** Uses `useQuery` for caching subscription data.

### 5. User Experience & Edge Cases

*   **Loading States:** The UI will display skeleton loaders while the pricing plans are being fetched.
*   **Error Handling:** API errors (e.g., failed payment, invalid card) will be caught and displayed as user-friendly notifications or inline messages.
*   **Disabled States:** Purchase buttons will be disabled during form submission to prevent duplicate requests.
*   **Authentication:** The page will be accessible only to authenticated users. The user's current plan will be clearly indicated.

### 6. Next Steps

With the pricing page UI defined, the next logical step is to create the comprehensive UI for the entire Content & Analysis Suite, which is the primary consumer of the purchased AI credits. The next document will be `6.9-Frontend-Intelligence-Hub-UI.md`.
